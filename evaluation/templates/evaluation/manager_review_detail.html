{% extends "evaluation/base.html" %}
{% block title %}Manager Review{% endblock %}

{% block content %}
<div class="flex items-center justify-between mb-6">
  <h1 class="text-2xl font-semibold text-red-500">
    {{ cycle.get_cycle_type_display }} Review •
    {{ subject.user.get_full_name|default:subject.user.username }}
  </h1>
  <div class="flex items-center gap-3">
    <span class="px-3 py-1 rounded bg-green-600 text-white text-sm">Submitted</span>
    {% if can_edit %}
      <a href="{% url 'evaluation:evaluate_manager' evaluation.id %}?edit=1"
         class="px-3 py-1 rounded bg-red-600 hover:bg-red-500 text-white text-sm">Edit</a>
    {% endif %}
  </div>
</div>

<div class="space-y-5 max-w-3xl">
  {% if evaluation.regular_evaluations %}
    <section class="bg-[#111] border border-gray-700 rounded p-4">
      <h2 class="text-gray-300 text-sm mb-1">Regular Evaluations</h2>
      <p class="text-gray-100 whitespace-pre-line">{{ evaluation.regular_evaluations }}</p>
    </section>
  {% endif %}

  {% if evaluation.performance_summary %}
    <section class="bg-[#111] border border-gray-700 rounded p-4">
      <h2 class="text-gray-300 text-sm mb-1">Quarterly/Monthly Performance Summary</h2>
      <p class="text-gray-100 whitespace-pre-line">{{ evaluation.performance_summary }}</p>
    </section>
  {% endif %}

  {% if evaluation.annual_review %}
    <section class="bg-[#111] border border-gray-700 rounded p-4">
      <h2 class="text-gray-300 text-sm mb-1">Annual Performance Review</h2>
      <p class="text-gray-100 whitespace-pre-line">{{ evaluation.annual_review }}</p>
    </section>
  {% endif %}

  <div class="grid md:grid-cols-2 gap-4">
    <section class="bg-[#111] border border-gray-700 rounded p-4">
      <h2 class="text-gray-300 text-sm mb-1">Goals Achieved</h2>
      <p class="text-gray-100 whitespace-pre-line">{{ evaluation.goals_achieved|default:"—" }}</p>
    </section>
    <section class="bg-[#111] border border-gray-700 rounded p-4">
      <h2 class="text-gray-300 text-sm mb-1">Set Objectives</h2>
      <p class="text-gray-100 whitespace-pre-line">{{ evaluation.objectives_set|default:"—" }}</p>
    </section>
  </div>

  <div class="grid md:grid-cols-2 gap-4">
    <section class="bg-[#111] border border-gray-700 rounded p-4">
      <h2 class="text-gray-300 text-sm mb-1">Strengths</h2>
      <p class="text-gray-100 whitespace-pre-line">{{ evaluation.strengths|default:"—" }}</p>
    </section>
    <section class="bg-[#111] border border-gray-700 rounded p-4">
      <h2 class="text-gray-300 text-sm mb-1">Areas for Improvement</h2>
      <p class="text-gray-100 whitespace-pre-line">{{ evaluation.improvement_areas|default:"—" }}</p>
    </section>
  </div>

  <section class="bg-[#111] border border-gray-700 rounded p-4">
    <h2 class="text-gray-300 text-sm mb-2">Overall Rating</h2>
    {% if evaluation.overall_rating %}
      <div class="flex items-center gap-2">
        {% for i in "12345" %}
          {% with idx=forloop.counter %}
            {% if idx <= evaluation.overall_rating %}
              <i class="fa-solid fa-star text-red-500 text-xl"></i>
            {% else %}
              <i class="fa-regular fa-star text-gray-500 text-xl"></i>
            {% endif %}
          {% endwith %}
        {% endfor %}
        <span class="text-gray-400 text-sm">{{ evaluation.overall_rating }}/5</span>
      </div>
    {% else %}
      <span class="text-gray-400">—</span>
    {% endif %}
  </section>

  {% if evaluation.supervisors_comments %}
    <section class="bg-[#111] border border-gray-700 rounded p-4">
      <h2 class="text-gray-300 text-sm mb-1">Supervisor’s Comments & Observations</h2>
      <p class="text-gray-100 whitespace-pre-line">{{ evaluation.supervisors_comments }}</p>
    </section>
  {% endif %}

  <div class="text-gray-500 text-sm">
    Submitted at: {{ evaluation.submitted_at|date:"M j, Y, g:i a" }}
  </div>
</div>
{% endblock %}
